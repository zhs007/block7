package main

import (
	"github.com/zhs007/block7"
	block7http "github.com/zhs007/block7/http"
	goutils "github.com/zhs007/goutils"
	"go.uber.org/zap"
)

func main() {
	goutils.InitLogger("block7serv.client", block7.Version,
		"info", true, "./logs")

	ret, buf, err := block7http.HTTPGet("http://127.0.0.1:3723/v1/games/login", nil)
	if err != nil {
		goutils.Error("HTTPGet",
			zap.Error(err))

		return
	}

	goutils.Info("missiondata",
		zap.Int("ret", ret),
		zap.String("buf", string(buf)))

	ret, buf, err = block7http.HTTPPostEx("http://127.0.0.1:3723/v1/games/missiondata", nil,
		[]byte(`{"history":[[5,2,3,2],[3,4,3,3],[3,6,3,3],[5,6,3,4],[7,4,3,4],[5,8,3,5],[7,8,3,5],[5,1,2,7],[4,6,1,8],[3,5,2,8],[1,4,3,8],[5,7,2,9],[7,7,2,9],[7,6,3,10],[1,3,2,10],[1,2,3,11],[5,2,1,12],[3,8,3,12],[4,2,1,13],[7,5,2,14],[3,7,2,14],[3,3,2,16],[5,6,1,16],[6,4,1,17],[3,4,1,17],[2,4,1,17],[5,1,0,18],[3,3,0,20],[3,6,1,21],[6,8,1,21],[3,2,3,23],[1,6,3,24],[7,6,1,24],[5,2,0,25],[0,4,1,25],[1,8,3,26],[6,6,1,27],[2,8,1,27],[1,5,2,28],[3,1,2,28],[7,5,0,29],[5,6,0,31],[5,8,1,31],[1,4,1,32],[7,6,0,33],[7,8,1,34],[7,4,1,34],[2,2,1,37],[1,3,0,37],[5,4,3,40],[1,4,0,41],[5,7,0,41],[2,6,1,43],[7,2,3,44],[5,3,2,45],[5,8,0,47],[7,1,2,47],[1,1,2,48],[6,2,1,49],[3,5,0,50],[1,6,1,51],[0,2,1,52],[7,8,0,52],[7,7,0,53],[5,4,1,53],[4,4,1,53],[3,6,0,56],[3,2,1,56],[3,2,0,56],[3,1,0,57],[5,3,0,57],[5,4,0,58],[7,2,1,59],[7,3,0,59],[7,2,0,60],[1,8,1,62],[1,2,1,63],[3,8,1,64],[3,7,0,64],[0,6,1,64],[1,8,0,65],[3,8,0,65],[1,7,0,66],[1,1,0,66],[1,5,0,68],[1,6,0,70]],"missionid":99,"stageType":"0","firstItem":0,"blockNums":7,"initArr":[[[0,4,0,4,0,6,0,23],[0,20,0,12,0,4,0,27],[0,301,0,5,0,5,0,3],[0,301,0,301,0,403,0,301],[0,4,0,403,0,301,0,403],[0,301,0,6,0,301,0,7],[0,301,0,5,0,20,0,7],[0,20,0,301,0,301,0,403]],[[403,20,18,12,403,5,6,3],[0,0,0,0,0,0,0,0],[12,23,3,6,12,23,18,7],[0,0,0,0,0,0,0,0],[20,5,301,301,27,27,23,3],[0,0,0,0,0,0,0,0],[23,4,301,5,301,27,301,7],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,403,0,301,0,18,0,18],[0,0,0,0,0,0,0,0],[0,18,0,12,0,403,0,301],[0,0,0,0,0,0,0,0],[0,301,0,23,0,3,0,403],[0,0,0,0,0,0,0,0],[0,6,0,301,0,301,0,6]],[[0,20,0,27,0,301,0,301],[0,0,0,0,0,0,0,0],[0,7,0,301,0,301,0,18],[0,0,0,0,0,0,0,0],[0,12,0,301,0,4,0,301],[0,0,0,0,0,0,0,0],[0,27,0,7,0,301,0,3],[0,0,0,0,0,0,0,0]]],"specialLayers":[],"userHash":"DNPtg0uySYujFGnI","rngdata":[133,10],"gamestate":1}`))
	if err != nil {
		goutils.Error("HTTPPostEx",
			zap.Error(err))

		return
	}

	goutils.Info("missiondata",
		zap.Int("ret", ret),
		zap.String("buf", string(buf)))

	ret, buf, err = block7http.HTTPGet("http://127.0.0.1:3723/v1/games/mission?userHash=DNPtg0uySYujFGnI&history=5&missionid=99", nil)
	if err != nil {
		goutils.Error("HTTPGet",
			zap.Error(err))

		return
	}

	goutils.Info("missiondata",
		zap.Int("ret", ret),
		zap.String("buf", string(buf)))
}
